syntax = "proto3";

// package user;
option go_package = "telepathy-server/proto";

import "error.proto";
import "user.proto";

service AuthService {
    rpc CreateAuthCode (CreateAuthCodeRequest) returns (CreateAuthCodeResponse){}
    rpc ValidateAuthCode (ValidateAuthCodeRequest) returns (ValidateAuthCodeResponse){}
    rpc SignUp (SignUpRequest) returns (SignUpResponse){}
    rpc LoginWithCode (LoginWithCodeRequest) returns (LoginResponse){}
    rpc LoginWithPassword (LoginWithPasswordRequest) returns (LoginResponse){}
}

message AuthUser {
    string uid = 1;
    PhoneNumber phone = 2;
    string password = 3;
    int64 createdAt = 4; // UnixTime -> change to localtime (ex. kst)
    int64 phoneNumberUpdatedAt = 5; // UnixTime
    int64 passwordUpdatedAt = 6;
}

message PhoneNumber {
    string num = 1; // 전화번호
    string country = 2; // 국가 번호 ex) 82
}

message Term {
    string uid = 1;
    bool agree = 2;
    int64 createdAt = 3; // UnixTime -> change to localtime (ex. kst)
    int64 updatedAt = 4; // UnixTime
}

/* CreateAuthCode */

message CreateAuthCodeRequest {
    PhoneNumber phone = 1;
}

message CreateAuthCodeResponse {
    Status status = 1;
}

/* CreateAuthCode */
/* ValidateAuthCode */

message ValidateAuthCodeRequest {
    PhoneNumber phone = 1;
    string code = 2;
}

message ValidateAuthCodeResponse {
    Status status = 1;
}

/* ValidateAuthCode */
/* SignUpRequest */

/*
SignUpRequest : {
    user: {
        uid: "",
        name: "윤민우",
        gender: false,
        birth: "20030407"
        phoneNumber: "01041948536"
        createdAt: 	0,
        updatedAt: 	0,
    },
    phone: {
        num: "01041948536",
        country: "82"
    }
    password: "testPassword"
}
*/
message SignUpRequest { // user.uid / user.createdAt / user.updatedAt not needed in this request
    User user = 1;
    PhoneNumber phone = 2;
    string password = 3;
}

message SignUpResponse {
    Status status = 1;
}

/* SignUpRequest */
/* LoginWithCode & LoginWithPassword */

message LoginWithCodeRequest { // all fields required
    PhoneNumber phone = 1;
    string code = 2;
}

message LoginWithPasswordRequest { // all fields required
    PhoneNumber phone = 1;
    string password = 2;
}

message LoginResponse {
    Status status = 1;
}

/* LoginWithCode & LoginWithPassword */